var currentLanguage = null;
var languagePath = "lang/";
var currentLanguageDict = null;
function setLanguage(lang) {
  currentLanguage = lang;
  var jsonFile = languagePath + currentLanguage + ".json";
  $.getJSON(jsonFile, function (langData) {
    currentLanguageDict = langData;
    reloadTranslations();
  });
}

function reloadTranslations() {
  $("[translate]").each(function () {
    var translationAttr = $(this).attr("translate");
    $(this).text(getInstantTranslation(translationAttr));
  });
}

function getInstantTranslation(dictKey) {
  var assocValue = currentLanguageDict;
  var translationAttr = dictKey;
  var keyPathTokens = translationAttr.split(".");
  for (const key of keyPathTokens) {
    if (assocValue !== null) {
      if (key in assocValue) {
        assocValue = assocValue[key];
      } else {
        return "{{ " + dictKey + " }}";
      }
    }
  }
  return assocValue;
}
